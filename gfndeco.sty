%===============================================================================
%    gfndeco.sty  (C) @bd_gfngfn on Twitter
%
%===============================================================================
\newcommand{\thicksection}[1]{
\clearpage
\noindent
\samepage
\begin{tikzpicture}
\draw[line width=2pt] (0,0) -- (\textwidth,0);
\draw[line width=1pt] (0,-5pt) -- (\textwidth,-5pt);
\end{tikzpicture}
\refstepcounter{section}
\parbox[c][3zw][c]{\textwidth}{\enskip\textsf{\LARGE \arabic{section} #1}}
\addcontentsline{toc}{section}{#1}
\begin{tikzpicture}
\draw[line width=1pt] (0,0) -- (\textwidth,0);
\draw[line width=2pt] (0,-5pt) -- (\textwidth,-5pt);
\end{tikzpicture}
\par
\nopagebreak
\vblank
}
%
\newcommand{\thicksectionnonum}[1]{
\clearpage
\noindent
\begin{tikzpicture}
\draw[line width=2pt] (0,0) -- (\textwidth,0);
\draw[line width=1pt] (0,-5pt) -- (\textwidth,-5pt);
\end{tikzpicture}
\parbox[c][3zw][c]{\textwidth}{\enskip\textsf{\LARGE \enskip#1}}
\begin{tikzpicture}
\draw[line width=1pt] (0,0) -- (\textwidth,0);
\draw[line width=2pt] (0,-5pt) -- (\textwidth,-5pt);
\end{tikzpicture}
\par
\nopagebreak
\vblank
}
%
\newcommand{\thicksubsection}[1]{%
  \noindent
  \samepage
  \refstepcounter{subsection}
  \parbox[c][1.25zw][c]{\textwidth}{\textsf{\large \arabic{section}.\arabic{subsection} #1}}
  \addcontentsline{toc}{subsection}{#1}%
  \parbox[c][1zw][t]{\textwidth}{%
    \begin{tikzpicture}
      \draw[line width=1pt] (0,0)--(\textwidth,0);
    \end{tikzpicture}
  }
  \par
  \nopagebreak
  \vblank
}%
%==============================================================================
\newcommand{\newdecoclass}[1]{%
  \expandafter\newcommand\expandafter{\csname prefixof#1@gfndeco\endcsname}{}%
  \expandafter\newcommand\expandafter{\csname setprefixof#1\endcsname}[1]{%
    \expandafter\renewcommand\expandafter{\csname prefixof#1@gfndeco\endcsname}{##1}%
  }%
  \expandafter\newcommand\expandafter{\csname deco#1\endcsname}[3][\relax]{\stdcmd@gfndeco{##1}{##2}{##3}{\csname prefixof#1@gfndeco\endcsname}}%
  \expandafter\newcommand\expandafter{\csname setstyleof#1\endcsname}[1]{%
    \expandafter\renewcommand\expandafter{\csname deco#1\endcsname}[3][\relax]{%
      \csname##1cmd@gfndeco\endcsname{####1}{####2}{####3}{\csname prefixof#1@gfndeco\endcsname}%
    }%
  }%
}%
\newcommand{\newnonumdecoclass}[1]{%
  \expandafter\newcommand\expandafter{\csname prefixof#1@gfndeco\endcsname}{}%
  \expandafter\newcommand\expandafter{\csname setprefixof#1\endcsname}[1]{%
    \expandafter\renewcommand\expandafter{\csname prefixof#1@gfndeco\endcsname}{##1}%
  }%
  \expandafter\newcommand\expandafter{\csname deco#1\endcsname}[2]{\stdnonum@gfndeco{##1}{##2}{\csname prefixof#1@gfndeco\endcsname}}%
  \expandafter\newcommand\expandafter{\csname setstyleof#1\endcsname}[1]{%
    \expandafter\renewcommand\expandafter{\csname deco#1\endcsname}[2]{%
      \csname##1nonum@gfndeco\endcsname{####1}{####2}{\csname prefixof#1@gfndeco\endcsname}%
    }%
  }%
}%
% \newdecoclass{●} あるいは \newnonumdecoclass{●} により \setprefixof●，\setstyleof●，\deco● がそれぞれつくられる
%   +--------------------------------+
%   |  \newdecoclass{●}             |
%   |  \setprefixof●{▲}            |
%   |  \setstyleof●{■}             |
%   +--------------------------------+
% とすることで，分類●（例えば"def"）の接頭語が▲（例えば「定義」）に，スタイルが■（例えば"ul"）に設定される
% \setprefixof● を特に指定していない場合，接頭語は空文字列になる
% \setstyleof● を特に指定していない場合，スタイルはstdになる
% 接頭語，スタイルともに文書の途中で変更することもできるが，統一性の観点から非推奨
% \newdecoclass は番号つきの分類を，\newnonumdecoclass は番号なしの分類をつくる
% 分類の名前空間は番号つきと番号なしで分けていないので
%   +--------------------------------+
%   |  \newdecoclass{hoge}           |
%   |  \newnonumdecoclass{hoge}      |
%   +--------------------------------+
% は重複定義になってしまう
% 以下は最初から使えるもの
\newdecoclass{def}\setprefixofdef{定義}%
\newdecoclass{thm}\setprefixofthm{定理}%
\newdecoclass{lem}\setprefixoflem{補題}%
\newdecoclass{cor}\setprefixofcor{系}%
\newnonumdecoclass{proof}\setprefixofproof{証明}%
\newnonumdecoclass{compl}\setprefixofcompl{補足}%
%
\newcommand{\decopunctu@gfndeco}{}%
\newcommand{\decopunctb@gfndeco}{.}%
\newcommand{\decopunctt@gfndeco}{.}%
\newcommand{\decopunctq@gfndeco}{}%
\newcommand{\setdecopuncts}[4]{%
  \renewcommand{\decopunctu@gfndeco}{#1}%
  \renewcommand{\decopunctb@gfndeco}{#2}%
  \renewcommand{\decopunctt@gfndeco}{#3}%
  \renewcommand{\decopunctq@gfndeco}{#4}%
}%
\newcommand{\writenonemptytitle@gfndeco}[1]{%
  \edef\tempparam@gfndeco{#1}%
  \ifx\tempparam@gfndeco\empty%
    \relax%
  \else%
    \enskip#1%
  \fi%
}%
\newcommand{\writenumbering@gfndeco}{%
  \decopunctu@gfndeco\arabic{section}%
  \decopunctb@gfndeco\arabic{subsection}%
  \decopunctt@gfndeco\arabic{subsubsection}%
  \decopunctq@gfndeco%
}%
\newcommand{\dealwithcounter@gfndeco}[1]{%
  \refstepcounter{subsubsection}%
  \if\relax#1%
  \else%
    \label{#1}%
  \fi%
}%
\newcommand{\writenonumtitle@gfndeco}[2]{%
  \edef\tempparam@gfndeco{#1}%
  \ifx\tempparam@gfndeco\empty%
    #2%
  \else%
    \edef\tempparam@gfndeco{#2}%
    \ifx\tempparam@gfndeco\empty%
      #1%
    \else%
      #1\enskip#2%
    \fi%
  \fi%
}
%---基本----------------------------------------------------
\newcommand{\stdcmd@gfndeco}[4]{%
  \dealwithcounter@gfndeco{#1}%
  \noindent
  \textsf{#4\writenumbering@gfndeco\writenonemptytitle@gfndeco{#2}}
  \par\nopagebreak
  \indent
  #3
  \par
  \allowbreak
  \vblank
}%
\newcommand{\stdnonum@gfndeco}[3]{%
  \noindent
  \textsf{\writenonumtitle@gfndeco{#3}{#1}}
  \par\nopagebreak
  \indent
  #2
  \par
  \vblank
}%
%
%---下線つき----------------------------------------------------
\newcommand{\ulcmd@gfndeco}[4]{%
  \dealwithcounter@gfndeco{#1}%
  \noindent
  \underline{\textsf{#4\writenumbering@gfndeco\writenonemptytitle@gfndeco{#2}}}
  \par\nopagebreak
  \indent
  #3
  \par
  \allowbreak
  \vblank
}
\newcommand{\ulnonum@gfndeco}[3]{%
  \noindent
  \underline{\textsf{\writenonumtitle@gfndeco{#3}{#1}}}
  \par\nopagebreak
  \indent
  #2
  \par
  \allowbreak
  \vblank
}%
%
%---タイトル込み段落--------------------------------------------
\newcommand{\topcmd@gfndeco}[4]{%
  \dealwithcounter@gfndeco{#1}%
  \noindent
  \textsf{#4\writenumbering@gfndeco\writenonemptytitle@gfndeco{#2}}\quad#3
  \par
  \allowbreak
  \vblank
}%
\newcommand{\topnonum@gfndeco}[3]{%
\noindent
\textsf{\writenonumtitle@gfndeco{#3}{#1}}\quad#2
\par
\allowbreak
\vblank
}%
%
%---箱入り------------------------------------------------------
\newcommand{\boxcmd@gfndeco}[4]{%
  \dealwithcounter@gfndeco{#1}%
  \noindent
  \begin{itembox}[l]{\textsf{#4\writenumbering@gfndeco\writenonemptytitle@gfndeco{#2}}}
    #3
  \end{itembox}
  \par
  \vblank
}%
\newcommand{\boxnonum@gfndeco}[3]{%
\noindent
\begin{itembox}[l]{\textsf{\writenonumtitle@gfndeco{#3}{#1}}}
#2
\end{itembox}
\par\vblank
}%
